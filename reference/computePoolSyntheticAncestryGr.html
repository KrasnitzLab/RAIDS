<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Run a PCA analysis and a K-nearest neighbors analysis on a small set
of synthetic data using all 1KG profiles except the ones used to generate
the synthetic profiles — computePoolSyntheticAncestryGr • RAIDS</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Run a PCA analysis and a K-nearest neighbors analysis on a small set
of synthetic data using all 1KG profiles except the ones used to generate
the synthetic profiles — computePoolSyntheticAncestryGr"><meta property="og:description" content="The function runs a PCA analysis using 1 synthetic profile
from each sub-continental population. The reference profiles used to
create those synthetic profiles are first removed from the list
of 1KG reference profiles that generates the reference PCA. Then, the
retained synthetic
profiles are projected on the 1KG PCA space. Finally, a K-nearest neighbors
analysis using a range of K and D values is done."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RAIDS</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.99.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/RAIDS.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Create_Reference_GDS_File.html">Population reference dataset GDS files</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/KrasnitzLab/RAIDS/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Run a PCA analysis and a K-nearest neighbors analysis on a small set
of synthetic data using all 1KG profiles except the ones used to generate
the synthetic profiles</h1>
    <small class="dont-index">Source: <a href="https://github.com/KrasnitzLab/RAIDS/blob/HEAD/R/processStudy.R" class="external-link"><code>R/processStudy.R</code></a></small>
    <div class="hidden name"><code>computePoolSyntheticAncestryGr.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The function runs a PCA analysis using 1 synthetic profile
from each sub-continental population. The reference profiles used to
create those synthetic profiles are first removed from the list
of 1KG reference profiles that generates the reference PCA. Then, the
retained synthetic
profiles are projected on the 1KG PCA space. Finally, a K-nearest neighbors
analysis using a range of K and D values is done.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">computePoolSyntheticAncestryGr</span><span class="op">(</span></span>
<span>  <span class="va">gdsProfile</span>,</span>
<span>  <span class="va">sampleRM</span>,</span>
<span>  <span class="va">spRef</span>,</span>
<span>  <span class="va">studyIDSyn</span>,</span>
<span>  np <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  listCatPop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"EAS"</span>, <span class="st">"EUR"</span>, <span class="st">"AFR"</span>, <span class="st">"AMR"</span>, <span class="st">"SAS"</span><span class="op">)</span>,</span>
<span>  fieldPopInfAnc <span class="op">=</span> <span class="st">"SuperPop"</span>,</span>
<span>  kList <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">15</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  pcaList <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">15</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  algorithm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"exact"</span>, <span class="st">"randomized"</span><span class="op">)</span>,</span>
<span>  eigenCount <span class="op">=</span> <span class="fl">32L</span>,</span>
<span>  missingRate <span class="op">=</span> <span class="fl">0.025</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>gdsProfile</dt>
<dd><p>an object of class
<code><a href="https://rdrr.io/pkg/SNPRelate/man/SNPGDSFileClass-class.html" class="external-link">SNPRelate::SNPGDSFileClass</a></code>, the
opened Profile GDS file.</p></dd>


<dt>sampleRM</dt>
<dd><p>a <code>vector</code> of <code>character</code> strings representing
the identifiers of the 1KG reference profiles that should not be used to
create the reference PCA. There should be one per sub-continental
population. Those profiles are
removed because those have been used to generate the synthetic profiles
that are going to be analysed here. The sub-continental
identifiers are used as names for the <code>vector</code>.</p></dd>


<dt>spRef</dt>
<dd><p><code>vector</code> of <code>character</code> strings representing the
known super population ancestry for the 1KG profiles. The 1KG profile
identifiers are used as names for the <code>vector</code>.</p></dd>


<dt>studyIDSyn</dt>
<dd><p>a <code>character</code> string corresponding to the study
identifier.
The study identifier must be present in the Profile GDS file.</p></dd>


<dt>np</dt>
<dd><p>a single positive <code>integer</code> representing the number of
threads. Default: <code>1L</code>.</p></dd>


<dt>listCatPop</dt>
<dd><p>a <code>vector</code> of <code>character</code> string
representing the list of possible ancestry assignations. Default:
<code>("EAS", "EUR", "AFR", "AMR", "SAS")</code>.</p></dd>


<dt>fieldPopInfAnc</dt>
<dd><p>a <code>character</code> string representing the name of
the column that will contain the inferred ancestry for the specified
dataset. Default: <code>"SuperPop"</code>.</p></dd>


<dt>kList</dt>
<dd><p>a <code>vector</code> of <code>integer</code> representing  the list of
values tested for the  <em>K</em> parameter. The <em>K</em> parameter represents the
number of neighbors used in the K-nearest neighbor analysis. If <code>NULL</code>,
the value <code>seq(2,15,1)</code> is assigned.
Default: <code>seq(2,15,1)</code>.</p></dd>


<dt>pcaList</dt>
<dd><p>a <code>vector</code> of <code>integer</code> representing  the list of
values tested for the  <em>D</em> parameter. The <em>D</em> parameter represents the
number of dimensions used in the PCA analysis.  If <code>NULL</code>,
the value <code>seq(2,15,1)</code> is assigned.
Default: <code>seq(2,15,1)</code>.</p></dd>


<dt>algorithm</dt>
<dd><p>a <code>character</code> string representing the algorithm used
to calculate the PCA. The 2 choices are "exact" (traditional exact
calculation) and "randomized" (fast PCA with randomized algorithm
introduced in Galinsky et al. 2016). Default: <code>"exact"</code>.</p></dd>


<dt>eigenCount</dt>
<dd><p>a single <code>integer</code> indicating the number of
eigenvectors that will be in the output of the <a href="https://rdrr.io/pkg/SNPRelate/man/snpgdsPCA.html" class="external-link">snpgdsPCA</a>
function; if 'eigenCount' &lt;= 0, then all eigenvectors are returned.
Default: <code>32L</code>.</p></dd>


<dt>missingRate</dt>
<dd><p>a <code>numeric</code> value representing the threshold
missing rate at with the SNVs are discarded; the SNVs are retained in the
<a href="https://rdrr.io/pkg/SNPRelate/man/snpgdsPCA.html" class="external-link">snpgdsPCA</a> function
with "&lt;= missingRate" only; if <code>NaN</code>, no missing threshold.
Default: <code>0.025</code>.</p></dd>


<dt>verbose</dt>
<dd><p>a <code>logical</code> indicating if message information should be
printed. Default: <code>FALSE</code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>a <code>list</code> containing the following entries:</p><ul><li><p>sample.ida <code>vector</code> of <code>character</code> strings representing
the identifiers of the synthetic profiles.</p></li>
<li><p>sample1Kga <code>vector</code> of <code>character</code> strings representing
the identifiers of the reference 1KG profiles used to generate the
synthetic profiles.</p></li>
<li><p>spa <code>vector</code> of <code>character</code> strings representing the
known ancestry for the reference 1KG profiles used to generate the
synthetic profiles.</p></li>
<li><p>matKNNa <code>data.frame</code> containing 4 columns. The first column
'sample.id' contains the name of the synthetic profile. The second column
'D' represents the dimension D used to infer the ancestry. The third column
'K' represents the number of neighbors K used to infer the ancestry. The
fourth column 'SuperPop' contains the inferred ancestry.</p></li>
</ul></div>
    <div id="references">
    <h2>References</h2>
    <p>Galinsky KJ, Bhatia G, Loh PR, Georgiev S, Mukherjee S, Patterson NJ,
Price AL. Fast Principal-Component Analysis Reveals Convergent Evolution
of ADH1B in Europe and East Asia. Am J Hum Genet. 2016 Mar 3;98(3):456-72.
doi: 10.1016/j.ajhg.2015.12.022. Epub 2016 Feb 25.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Pascal Belleau, Astrid Deschênes and Alexander Krasnitz</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Required library</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/zhengxwen/gdsfmt" class="external-link">gdsfmt</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Path to the demo Profile GDS file is located in this package</span></span></span>
<span class="r-in"><span><span class="va">dataDir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/demoKNNSynthetic"</span>, package<span class="op">=</span><span class="st">"RAIDS"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The name of the synthetic study</span></span></span>
<span class="r-in"><span><span class="va">studyID</span> <span class="op">&lt;-</span> <span class="st">"MYDATA.Synthetic"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">samplesRM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"HG00246"</span>, <span class="st">"HG00325"</span>, <span class="st">"HG00611"</span>, <span class="st">"HG01173"</span>, <span class="st">"HG02165"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"HG01112"</span>, <span class="st">"HG01615"</span>, <span class="st">"HG01968"</span>, <span class="st">"HG02658"</span>, <span class="st">"HG01850"</span>, <span class="st">"HG02013"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"HG02465"</span>, <span class="st">"HG02974"</span>, <span class="st">"HG03814"</span>, <span class="st">"HG03445"</span>, <span class="st">"HG03689"</span>, <span class="st">"HG03789"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"NA12751"</span>, <span class="st">"NA19107"</span>, <span class="st">"NA18548"</span>, <span class="st">"NA19075"</span>, <span class="st">"NA19475"</span>, <span class="st">"NA19712"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"NA19731"</span>, <span class="st">"NA20528"</span>, <span class="st">"NA20908"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">samplesRM</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GBR"</span>, <span class="st">"FIN"</span>, <span class="st">"CHS"</span>,<span class="st">"PUR"</span>, <span class="st">"CDX"</span>, <span class="st">"CLM"</span>, <span class="st">"IBS"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"PEL"</span>, <span class="st">"PJL"</span>, <span class="st">"KHV"</span>, <span class="st">"ACB"</span>, <span class="st">"GWD"</span>, <span class="st">"ESN"</span>, <span class="st">"BEB"</span>, <span class="st">"MSL"</span>, <span class="st">"STU"</span>, <span class="st">"ITU"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"CEU"</span>, <span class="st">"YRI"</span>, <span class="st">"CHB"</span>, <span class="st">"JPT"</span>, <span class="st">"LWK"</span>, <span class="st">"ASW"</span>, <span class="st">"MXL"</span>, <span class="st">"TSI"</span>, <span class="st">"GIH"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## The known ancestry for the 1KG reference profiles</span></span></span>
<span class="r-in"><span><span class="va">refKnownSuperPop</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">dataDir</span>, <span class="st">"knownSuperPop1KG.RDS"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Open the Profile GDS file</span></span></span>
<span class="r-in"><span><span class="va">gdsProfile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SNPRelate/man/snpgdsOpen.html" class="external-link">snpgdsOpen</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">dataDir</span>, <span class="st">"ex1.gds"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Run a PCA analysis and a K-nearest neighbors analysis on a small set</span></span></span>
<span class="r-in"><span><span class="co">## of synthetic data</span></span></span>
<span class="r-in"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu">computePoolSyntheticAncestryGr</span><span class="op">(</span>gdsProfile<span class="op">=</span><span class="va">gdsProfile</span>,</span></span>
<span class="r-in"><span>    sampleRM<span class="op">=</span><span class="va">samplesRM</span>, studyIDSyn<span class="op">=</span><span class="va">studyID</span>, np<span class="op">=</span><span class="fl">1L</span>, spRef<span class="op">=</span><span class="va">refKnownSuperPop</span>,</span></span>
<span class="r-in"><span>    kList<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">15</span>,<span class="fl">1</span><span class="op">)</span>, pcaList<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">15</span>,<span class="fl">1</span><span class="op">)</span>, eigenCount<span class="op">=</span><span class="fl">15L</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## The ancestry inference for the synthetic data using</span></span></span>
<span class="r-in"><span><span class="co">## different K and D values</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">matKNN</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         sample.id  D  K SuperPop</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 1.ex1.HG00246.1 10 10      SAS</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 1.ex1.HG00246.1 10 11      SAS</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 1.ex1.HG00246.1 10 12      SAS</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 1.ex1.HG00246.1 10 13      SAS</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 1.ex1.HG00246.1 10 14      SAS</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 1.ex1.HG00246.1 10 15      EAS</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Close Profile GDS file (important)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/gdsfmt/man/closefn.gds.html" class="external-link">closefn.gds</a></span><span class="op">(</span><span class="va">gdsProfile</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Pascal Belleau, Astrid Deschênes, Alexander Krasnitz.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

