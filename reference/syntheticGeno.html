<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Generate synthetic profiles for each cancer profile and 1KG
reference profile combination and add them to the Profile GDS file — syntheticGeno • RAIDS</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Generate synthetic profiles for each cancer profile and 1KG
reference profile combination and add them to the Profile GDS file — syntheticGeno"><meta property="og:description" content="The functions uses one cancer profile in combination with one
1KG reference profile to generate an synthetic profile that is saved in the
Profile GDS file.
When more than one 1KG reference profiles are specified,
the function recursively generates synthetic profiles for
each cancer profile + 1KG reference profile combination.
The number of
synthetic profiles generated by combination is specified by the number of
simulation requested."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RAIDS</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.99.14</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/RAIDS.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Create_Reference_GDS_File.html">Population reference dataset GDS files</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/KrasnitzLab/RAIDS/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Generate synthetic profiles for each cancer profile and 1KG
reference profile combination and add them to the Profile GDS file</h1>
    <small class="dont-index">Source: <a href="https://github.com/KrasnitzLab/RAIDS/blob/HEAD/R/synthetic.R" class="external-link"><code>R/synthetic.R</code></a></small>
    <div class="hidden name"><code>syntheticGeno.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The functions uses one cancer profile in combination with one
1KG reference profile to generate an synthetic profile that is saved in the
Profile GDS file.</p>
<p>When more than one 1KG reference profiles are specified,
the function recursively generates synthetic profiles for
each cancer profile + 1KG reference profile combination.</p>
<p>The number of
synthetic profiles generated by combination is specified by the number of
simulation requested.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">syntheticGeno</span><span class="op">(</span></span>
<span>  <span class="va">gdsReference</span>,</span>
<span>  <span class="va">gdsRefAnnot</span>,</span>
<span>  <span class="va">fileProfileGDS</span>,</span>
<span>  <span class="va">profileID</span>,</span>
<span>  <span class="va">listSampleRef</span>,</span>
<span>  nbSim <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  prefix <span class="op">=</span> <span class="st">""</span>,</span>
<span>  pRecomb <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  minProb <span class="op">=</span> <span class="fl">0.999</span>,</span>
<span>  seqError <span class="op">=</span> <span class="fl">0.001</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>gdsReference</dt>
<dd><p>an object of class <code><a href="https://rdrr.io/pkg/gdsfmt/man/gds.class.html" class="external-link">gds.class</a></code>
(a GDS file), the opened 1KG GDS file.</p></dd>


<dt>gdsRefAnnot</dt>
<dd><p>an object of class <code><a href="https://rdrr.io/pkg/gdsfmt/man/gds.class.html" class="external-link">gds.class</a></code>
(a GDS file), the opened 1KG SNV Annotation GDS file.</p></dd>


<dt>fileProfileGDS</dt>
<dd><p>a <code>character</code> string representing the file name
of Profile GDS file containing the information about the sample.
The file must exist.</p></dd>


<dt>profileID</dt>
<dd><p>a <code>character</code> string representing the unique
identifier of the cancer profile.</p></dd>


<dt>listSampleRef</dt>
<dd><p>a <code>vector</code> of <code>character</code> strings
representing the sample identifiers of the 1KG selected reference samples.</p></dd>


<dt>nbSim</dt>
<dd><p>a single positive <code>integer</code> representing the number of
simulations that will be generated per sample + 1KG reference combination.
Default: <code>1L</code>.</p></dd>


<dt>prefix</dt>
<dd><p>a <code>character</code> string that represent the prefix that will
be added to the name of the synthetic profiles generated by the function.
Default: <code>""</code>.</p></dd>


<dt>pRecomb</dt>
<dd><p>a single positive <code>numeric</code> between 0 and 1 that
represents the frequency of phase switching in the synthetic profiles,
Default: <code>0.01</code>.</p></dd>


<dt>minProb</dt>
<dd><p>a single positive <code>numeric</code> between 0 and 1 that
represents the probability that the genotype is correct.
Default: <code>0.999</code>.</p></dd>


<dt>seqError</dt>
<dd><p>a single positive <code>numeric</code> between 0 and 1
representing the sequencing error rate. Default: <code>0.001</code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>The integer <code>OL</code> when the function is successful.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Pascal Belleau, Astrid Deschênes and Alexander Krasnitz</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Required library</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/zhengxwen/gdsfmt" class="external-link">gdsfmt</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Path to the demo 1KG GDS file is located in this package</span></span></span>
<span class="r-in"><span><span class="va">dataDir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/tests"</span>, package<span class="op">=</span><span class="st">"RAIDS"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Profile GDS file (temporary)</span></span></span>
<span class="r-in"><span><span class="va">fileNameGDS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"ex1.gds"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Copy the Profile GDS file demo that has been pruned and annotated</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.copy</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">dataDir</span>, <span class="st">"ex1_demo_with_pruning_and_1KG_annot.gds"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 <span class="va">fileNameGDS</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Information about the synthetic data set</span></span></span>
<span class="r-in"><span><span class="va">syntheticStudyDF</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>study.id<span class="op">=</span><span class="st">"MYDATA.Synthetic"</span>,</span></span>
<span class="r-in"><span>        study.desc<span class="op">=</span><span class="st">"MYDATA synthetic data"</span>, study.platform<span class="op">=</span><span class="st">"PLATFORM"</span>,</span></span>
<span class="r-in"><span>        stringsAsFactors<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Add information related to the synthetic profiles into the Profile GDS</span></span></span>
<span class="r-in"><span><span class="fu"><a href="prepSynthetic.html">prepSynthetic</a></span><span class="op">(</span>fileProfileGDS<span class="op">=</span><span class="va">fileNameGDS</span>,</span></span>
<span class="r-in"><span>        listSampleRef<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"HG00243"</span>, <span class="st">"HG00150"</span><span class="op">)</span>, profileID<span class="op">=</span><span class="st">"ex1"</span>,</span></span>
<span class="r-in"><span>        studyDF<span class="op">=</span><span class="va">syntheticStudyDF</span>, nbSim<span class="op">=</span><span class="fl">1L</span>, prefix<span class="op">=</span><span class="st">"synthTest"</span>,</span></span>
<span class="r-in"><span>        verbose<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## The 1KG files</span></span></span>
<span class="r-in"><span><span class="va">gds1KG</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SNPRelate/man/snpgdsOpen.html" class="external-link">snpgdsOpen</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">dataDir</span>,</span></span>
<span class="r-in"><span>                            <span class="st">"ex1_good_small_1KG.gds"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gds1KGAnnot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gdsfmt/man/openfn.gds.html" class="external-link">openfn.gds</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">dataDir</span>,</span></span>
<span class="r-in"><span>                            <span class="st">"ex1_good_small_1KG_Annot.gds"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Generate the synthetic profiles and add them into the Profile GDS</span></span></span>
<span class="r-in"><span><span class="fu">syntheticGeno</span><span class="op">(</span>gdsReference<span class="op">=</span><span class="va">gds1KG</span>, gdsRefAnnot<span class="op">=</span><span class="va">gds1KGAnnot</span>,</span></span>
<span class="r-in"><span>        fileProfileGDS<span class="op">=</span><span class="va">fileNameGDS</span>, profileID<span class="op">=</span><span class="st">"ex1"</span>,</span></span>
<span class="r-in"><span>        listSampleRef<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"HG00243"</span>, <span class="st">"HG00150"</span><span class="op">)</span>, nbSim<span class="op">=</span><span class="fl">1</span>,</span></span>
<span class="r-in"><span>        prefix<span class="op">=</span><span class="st">"synthTest"</span>,</span></span>
<span class="r-in"><span>        pRecomb<span class="op">=</span><span class="fl">0.01</span>, minProb<span class="op">=</span><span class="fl">0.999</span>, seqError<span class="op">=</span><span class="fl">0.001</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Open Profile GDS file</span></span></span>
<span class="r-in"><span><span class="va">profileGDS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gdsfmt/man/openfn.gds.html" class="external-link">openfn.gds</a></span><span class="op">(</span><span class="va">fileNameGDS</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/gdsfmt/man/read.gdsn.html" class="external-link">read.gdsn</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/gdsfmt/man/index.gdsn.html" class="external-link">index.gdsn</a></span><span class="op">(</span><span class="va">profileGDS</span>, <span class="st">"sample.id"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "NA20872"                 "NA20906"                </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3] "NA20875"                 "ex1"                    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5] "synthTest.ex1.HG00243.1" "synthTest.ex1.HG00150.1"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Close GDS files (important)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/gdsfmt/man/closefn.gds.html" class="external-link">closefn.gds</a></span><span class="op">(</span><span class="va">profileGDS</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/gdsfmt/man/closefn.gds.html" class="external-link">closefn.gds</a></span><span class="op">(</span><span class="va">gds1KG</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/gdsfmt/man/closefn.gds.html" class="external-link">closefn.gds</a></span><span class="op">(</span><span class="va">gds1KGAnnot</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Remove Profile GDS file (created for demo purpose)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="va">fileNameGDS</span>, force<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Pascal Belleau, Astrid Deschênes, David A. Tuveson, Alexander Krasnitz.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

