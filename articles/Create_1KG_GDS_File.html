<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Formatting the information from 1000 Genomes (optional) • RAIDS</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Formatting the information from 1000 Genomes (optional)">
<meta property="og:description" content="RAIDS">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RAIDS</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.99.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/RAIDS.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Create_1KG_GDS_File.html">Formatting the information from 1000 Genomes (optional)</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/KrasnitzLab/RAIDS/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Formatting the information from 1000 Genomes
(optional)</h1>
                        <h4 data-toc-skip class="author">Pascal Belleau,
Astrid Deschênes and Alexander Krasnitz</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/KrasnitzLab/RAIDS/blob/HEAD/vignettes/Create_1KG_GDS_File.Rmd" class="external-link"><code>vignettes/Create_1KG_GDS_File.Rmd</code></a></small>
      <div class="hidden name"><code>Create_1KG_GDS_File.Rmd</code></div>

    </div>

    
    
<p><br><strong>Package</strong>: <em>RAIDS</em><br><strong>Authors</strong>: Pascal Belleau [cre, aut] (<a href="https://orcid.org/0000-0002-0802-1071" class="external-link uri">https://orcid.org/0000-0002-0802-1071</a>), Astrid Deschênes
[aut] (<a href="https://orcid.org/0000-0001-7846-6749" class="external-link uri">https://orcid.org/0000-0001-7846-6749</a>), Alexander
Krasnitz [aut]<br><strong>Version</strong>: 0.99.3<br><strong>Compiled date</strong>: 2023-04-10<br><strong>License</strong>: Apache License (&gt;= 2)<br></p>
<p><br><br></p>
<div class="section level2">
<h2 id="step-1---formatting-the-information-from-1000-genomes-optional">Step 1 - Formatting the information from 1000 Genomes
(optional)<a class="anchor" aria-label="anchor" href="#step-1---formatting-the-information-from-1000-genomes-optional"></a>
</h2>
<p>This is an overview of the main steps to infer the genetic
ancestry<br>
from cancer-derived molecular data:</p>
<ol style="list-style-type: decimal">
<li>Format the information from 1000 Genomes (1KG) into a 1KG GDS file
(optional)</li>
<li>Format the information from an external study</li>
<li>Find the optimized parameters for the ancestry inference</li>
<li>Run the ancestry inference on the external study</li>
</ol>
<div class="figure" style="text-align: center">
<img src="MainSteps_Step1_v01.png" alt="Step 1 - Formatting the information from 1000 Genomes (optional)" width="120%"><p class="caption">
Step 1 - Formatting the information from 1000 Genomes (optional)
</p>
</div>
<hr>
<p><span style="color:darkred;font-weight:bold">Beware that a
pre-processed 1KG GDS file is available at this address:</span></p>
<p><span style="color:red"> <a href="https://labshare.cshl.edu/shares/krasnitzlab/aicsPaper/matGeno1000g.gds" class="external-link">https://labshare.cshl.edu/shares/krasnitzlab/aicsPaper/matGeno1000g.gds</a>
</span></p>
<p><span style="color:darkred;font-weight:bold">The size of the file is
15GB.</span> <span style="color:darkred;font-weight:bold">This section
can be skipped if you choose to use this file.</span></p>
<hr>
<p>This section explains in further details how to generate the 1000
Genomes (1KG) GDS file that is needed to run the ancestry inference tool
(step 1). Beware that it is unnecessary to re-run those steps as the 1KG
GDS file is publicly available.</p>
<p>More specifically, the formatting of the 1KG information includes all
those sub-steps:</p>
<ol style="list-style-type: decimal">
<li>Download the required files from 1KG</li>
<li>Split the 1KG genotyping file to one file per sample per
chromosome</li>
<li>Combine the chromosomes to obtain one genotyping file per
sample</li>
<li>Create a pedigree file in RDS format</li>
<li>Prepare a bulk SNP information file based on 1KG VCF</li>
<li>Filter the bulk SNP information file</li>
<li>Generate the GDS file with the 1KG information</li>
<li>Identify genetically related patients present in 1KG GDS file</li>
<li>Add information about unrelated patients to the 1KG GDS file</li>
<li>Create a second GDS file containing the 1KG phase information</li>
</ol>
<p>Beware that those sub-steps are time, as well as, space
consuming.</p>
<p>In the following sections, those sub-steps are described in
details.</p>
<p><br></p>
<div class="section level3">
<h3 id="download-the-required-files-from-1kg">Download the required files from 1KG<a class="anchor" aria-label="anchor" href="#download-the-required-files-from-1kg"></a>
</h3>
<p>First, the pedigree file with the description of the 1KG samples
needs to be downloaded from the 1KG ftp site:</p>
<blockquote>
<p><a href="ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/technical/working/20130606_sample_info/20130606_g1k.ped" class="uri">ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/technical/working/20130606_sample_info/20130606_g1k.ped</a></p>
</blockquote>
<p>The genotyping files for the 1KG samples also needs to be downloaded.
Beware that there is one file per chromosome:</p>
<blockquote>
<p>ftp.1000genomes.ebi.ac.uk/vol1/ftp/data_collections/1000_genomes_project/release/20181203_biallelic_SNV</p>
</blockquote>
<p>As the genotyping files are split by chromosome, all files
corresponding to this pattern must be downloaded:</p>
<blockquote>
<p>ALL.chr*.shapeit2_integrated_v1a.GRCh38.20181129.phased.vcf.gz</p>
</blockquote>
<p>All files are related to GRCh38 genome.</p>
<p><br><br></p>
</div>
<div class="section level3">
<h3 id="split-the-1kg-genotyping-file-to-one-file-per-sample-per-chromosome">Split the 1KG genotyping file to one file per sample per
chromosome<a class="anchor" aria-label="anchor" href="#split-the-1kg-genotyping-file-to-one-file-per-sample-per-chromosome"></a>
</h3>
<p>To facilitate the manipulation of the genotyping data, the large 1KG
genotyping files are split into smaller files (one per sample).</p>
<p>As there is one genotyping file per chromosome, the process must be
executed for each of chromosome</p>
<p>The splitting is done through a bash script:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">## This in not a R script</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">## This script is in bash</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">## The script has to be run separately for each chromosome</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">## Create one directory for the specific chromosome</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co">##</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co">## Two variables need to be assigned</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co">## The variable PATHGENO is the path where the split 1KG genotyping</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co">##   files will be located</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co">## The variable chrCur is the current chromosome (ex: "chr1"), a sub-directory </span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co">##   with the name of the chromosome will be created. The variable must</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co">##   include the prefix "chr".</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co">##</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co">## Ex: PATHGENO=./genotypingPerSample</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co">## Ex: chrCur=chr1</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co">##</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="va">${PATHGENO}</span>/<span class="va">${chrCur}</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> <span class="va">${PATHGENO}</span>/<span class="va">${chrCur}</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="co">## The variable FILECUR is the associated 1KG genotyping VCF file for the</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="co">##     specific chromosome</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="co">## The variable FILECUR must also contain the relative or complete path to</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="co">##     the VCF file</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="co">## Ex: FILECUR=../../1KG_files/ALL.chr1.shapeit2_integrated_v1a.GRCh38.20181129.phased.vcf.gz</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="co">## There is 2548 samples in one phase VCF file</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="co">## The information associated to each sample is extracted and a VCF file </span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="co">## specific to each sample for the current chromosome is generated</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="co">##</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="kw">`</span><span class="fu">seq</span> 1 2548<span class="kw">`</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="cf">do</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>    <span class="va">j</span><span class="op">=</span><span class="va">$((</span> <span class="va">$i</span> <span class="op">+</span> <span class="dv">9</span> <span class="va">))</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>    <span class="va">SAMPLE</span><span class="op">=</span><span class="va">$(</span><span class="fu">zcat</span> <span class="va">$FILECUR</span><span class="kw">||</span><span class="fu">head</span> <span class="at">-n</span> 1000 <span class="kw">|</span><span class="fu">grep</span> <span class="st">"#CHROM"</span><span class="kw">|</span><span class="fu">cut</span> <span class="at">-d</span><span class="st">$'</span><span class="dt">\t</span><span class="st">'</span> <span class="at">-f</span><span class="va">$j)</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">zcat</span> <span class="va">$FILECUR</span><span class="kw">|</span><span class="fu">grep</span> <span class="at">-v</span> <span class="st">"##"</span><span class="kw">|</span><span class="fu">cut</span> <span class="at">-d</span><span class="st">$'</span><span class="dt">\t</span><span class="st">'</span> <span class="at">-f</span><span class="va">$j</span> <span class="kw">|</span><span class="fu">bzip2</span> <span class="at">-c</span> <span class="op">&gt;</span> <span class="va">${SAMPLE}</span>.<span class="va">${CHR}</span>.vcf.bz2</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span></code></pre></div>
<p><br><br></p>
</div>
<div class="section level3">
<h3 id="combine-the-chromosomes-to-obtain-one-genotyping-file-per-sample">Combine the chromosomes to obtain one genotyping file per
sample<a class="anchor" aria-label="anchor" href="#combine-the-chromosomes-to-obtain-one-genotyping-file-per-sample"></a>
</h3>
<p>The genotyping information for all chromosomes is merged so that
there is only one genotyping file per sample.</p>
<div class="figure" style="text-align: center">
<img src="groupChr1KGSNV_v01.png" alt="The function groupChr1KGSNV() merge samples that are split by chromosomes into one file." width="120%"><p class="caption">
The function groupChr1KGSNV() merge samples that are split by
chromosomes into one file.
</p>
</div>
<p>The <strong>groupChr1KGSNV()</strong> function is used to combine the
genotyping information from multiple files.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Load required package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://krasnitzlab.github.io/RAIDS/" class="external-link">RAIDS</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">## The path where the genotyping files are located</span></span>
<span><span class="va">pathGenoChr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"pathgenochr"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## The path where the merged genotyping files will be created</span></span>
<span><span class="va">PATHOUT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"pathgenoOUT"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Combining the genotyping information for all chromosome in one file per</span></span>
<span><span class="co">## sample</span></span>
<span><span class="fu"><a href="../reference/groupChr1KGSNV.html">groupChr1KGSNV</a></span><span class="op">(</span><span class="va">pathGenoChr</span>, <span class="va">PATHOUT</span><span class="op">)</span></span></code></pre></div>
<p><br><br></p>
</div>
<div class="section level3">
<h3 id="create-a-predigree-file-in-rds-format">Create a predigree file in RDS format<a class="anchor" aria-label="anchor" href="#create-a-predigree-file-in-rds-format"></a>
</h3>
<p>The function <strong>prepPed1KG()</strong> is used to create the
pedigree file in RDS format:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Load required package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://krasnitzlab.github.io/RAIDS/" class="external-link">RAIDS</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">## The path to the pedigree file from 1KG</span></span>
<span><span class="co">## In this example, the file is in the current directory</span></span>
<span><span class="va">filePED1KGOri</span> <span class="op">&lt;-</span> <span class="st">"20130606_g1k.ped"</span></span>
<span></span>
<span><span class="co">## Extract needed information from the pedigree file from 1KG into a data.frame</span></span>
<span><span class="co">## Only the samples with genotyping information (sample file present</span></span>
<span><span class="co">## in pathGeno parameter) are retained to create the final data.frame</span></span>
<span><span class="va">ped</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepPed1KG.html">prepPed1KG</a></span><span class="op">(</span>pedFile<span class="op">=</span><span class="va">filePED1KGOri</span>,</span>
<span>                    pathGeno<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"sampleGeno"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Save the pedigree information data.frame as a RDS file</span></span>
<span><span class="co">## In this example, the file is saved here ./data/metadata/ped1KG.rds</span></span>
<span><span class="va">filePED1KG</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"metadata"</span>,<span class="st">"ped1KG.rds"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">ped</span>,  <span class="va">filePED1KG</span><span class="op">)</span></span></code></pre></div>
<p><br><br></p>
</div>
<div class="section level3">
<h3 id="prepare-a-bulk-snp-information-file-based-on-1kg-vcf">Prepare a bulk SNP information file based on 1KG VCF<a class="anchor" aria-label="anchor" href="#prepare-a-bulk-snp-information-file-based-on-1kg-vcf"></a>
</h3>
<p>Some intermediate file containing the SNP information from 1KG need
to be generated so the information can ultimately be imported in a GDS
file using Bioconductor <a href="https://bioconductor.org/packages/gdsfmt/" class="external-link">gdsfmt</a>.</p>
<p>The bulk intermediate SNP file contains the SNP position as well as
the frequency in each super population.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="do">## This is not done in R</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="do">## The python script is in the 'scriptsPy' directory</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="cf">in</span> <span class="st">`</span><span class="at">ls PATHVCF/*shapeit2_integrated_v1a.GRCh38.20181129.phased.vcf.gz</span><span class="st">`</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>do</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    chr<span class="ot">=</span><span class="er">$</span>(echo <span class="sc">$</span>FILECUR<span class="sc">|</span>perl <span class="sc">-</span>n <span class="sc">-</span>e <span class="st">'/ALL\.(chr[^\.]+)/;print $1'</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    python PATH2SCRIPT<span class="sc">/</span>extract1000gFreq.py <span class="sc">$</span>{FILECUR} matFreq.<span class="sc">$</span>{chr}</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>done</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="cf">in</span> <span class="st">`</span><span class="at">seq 1 22</span><span class="st">`</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>do</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    cat matFreq.chr<span class="sc">$</span>{i}.txt <span class="sc">&gt;</span>matFreqSNV.txt</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    bzip2 matFreqSNV.txt</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>done</span></code></pre></div>
<p>The bulk SNP info file is called
<strong>matFreqSNV.txt.bz2</strong>.</p>
<p><br><br></p>
</div>
<div class="section level3">
<h3 id="filter-the-bulk-snp-information-file">Filter the bulk SNP information file<a class="anchor" aria-label="anchor" href="#filter-the-bulk-snp-information-file"></a>
</h3>
<p>The bulk SNP file is filtered to only retain the SNPs with frequency
higher then a specific cut-off (here &gt;=0.01) for at least one super
population.</p>
<p>The filter SNP file is saved in RDS format (<em>fileLSNP</em>
parameter). A second file containing the index of the retained SNPs is
also created (<em>fileLSNP</em> parameter)</p>
<p>The function <strong>generateMapSnvSel()</strong> is used to filter
the SNP file and generated the needed RDS files:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Load required package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://krasnitzlab.github.io/RAIDS/" class="external-link">RAIDS</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">## The path to the bulk SNP info file</span></span>
<span><span class="va">fileSNV.v</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">pathGeno</span>, <span class="st">"matFreqSNV.txt.bz2"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## The paths and names of the two output files</span></span>
<span><span class="co">## One file contains the index of retained SNPs ("listSNP.rds")</span></span>
<span><span class="co">## One file contains the filter SNP information ("mapSNVSel.rds")</span></span>
<span><span class="va">fileLSNP.v</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">PATHSEL</span>, <span class="st">"listSNP.rds"</span><span class="op">)</span></span>
<span><span class="va">fileFREQ.v</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">PATHSEL</span>, <span class="st">"mapSNVSel.rds"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Filter the bulk SNP file (fileSNV parameter)</span></span>
<span><span class="co">## Create a RDS with filter SNPs (fileFREQ parameter)</span></span>
<span><span class="co">## Also creates a RDS with the indexes of the retained SNPs (fileFREQ parameter)</span></span>
<span><span class="fu"><a href="../reference/generateMapSnvSel.html">generateMapSnvSel</a></span><span class="op">(</span>cutOff<span class="op">=</span><span class="fl">0.01</span>, fileSNV<span class="op">=</span><span class="va">fileSNV.v</span>,</span>
<span>                         fileLSNP<span class="op">=</span><span class="va">fileLSNP.v</span>,</span>
<span>                         fileFREQ<span class="op">=</span><span class="va">fileFREQ.v</span><span class="op">)</span></span></code></pre></div>
<p><br><br></p>
</div>
<div class="section level3">
<h3 id="generate-the-gds-file-with-the-1kg-information">Generate the GDS file with the 1KG information<a class="anchor" aria-label="anchor" href="#generate-the-gds-file-with-the-1kg-information"></a>
</h3>
<p>The CoreArray Genomic Data Structure (GDS) data files are files
suited for large-scale datasets, especially for data which are much
larger than the available random-access memory.</p>
<p>The function <strong>generateGDS1KG()</strong> is used to generate
the GDS file that will contain the information related to 1KG:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## TODO: what is PATHMETA and PATHSEL</span></span>
<span></span>
<span><span class="co">## The path and file names of the required files</span></span>
<span><span class="co">## First, the RDS file containing the pedigree information</span></span>
<span><span class="co">## Second, the RDS file with the indexes of the retained SNPs</span></span>
<span><span class="co">## Third, the RDS file with the filtered SNP information</span></span>
<span><span class="va">filePED1KG</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">PATHMETA</span>,<span class="st">"ped1KG.rds"</span><span class="op">)</span></span>
<span><span class="va">fileLSNP.v</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">PATHSEL</span>, <span class="st">"listSNP.rds"</span><span class="op">)</span></span>
<span><span class="va">fileFREQ.v</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">PATHSEL</span>, <span class="st">"mapSNVSel.rds"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## The name of the GDS file that will be created</span></span>
<span><span class="va">fileNameGDS</span> <span class="op">&lt;-</span> <span class="st">"matGeno1000g.gds"</span></span>
<span><span class="va">fileGDS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">PATHGDS</span>, <span class="va">fileNameGDS</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Generate GDS file containing the 1KG information</span></span>
<span><span class="fu"><a href="../reference/generateGDS1KG.html">generateGDS1KG</a></span><span class="op">(</span>pathGeno<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"sampleGeno"</span><span class="op">)</span>,</span>
<span>                    fileNamePED<span class="op">=</span><span class="va">filePED1KG</span>,</span>
<span>                    fileSNPSel<span class="op">=</span><span class="va">fileFREQ.v</span>,</span>
<span>                    fileListSNP<span class="op">=</span><span class="va">fileLSNP.v</span>,</span>
<span>                    fileNameGDS<span class="op">=</span><span class="va">fileGDS</span><span class="op">)</span></span></code></pre></div>
<p><br><br></p>
</div>
<div class="section level3">
<h3 id="identify-genetically-related-patients-present-in-1kg-gds-file">Identify genetically related patients present in 1KG GDS file<a class="anchor" aria-label="anchor" href="#identify-genetically-related-patients-present-in-1kg-gds-file"></a>
</h3>
<p>As only unrelated patients can be used in the following analyses, the
genetically related patients in 1KG must be identified.</p>
<p>The function <strong>identifyRelative()</strong> identifies patients
that are genetically related in the 1KG files. It generates a RDS file
with the unrelated patient information (<em>filePart</em> parameter) as
well as a RDS file with the kinship coefficient between the patients
(<em>fileIBD</em> parameter).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Load required package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/zhengxwen/gdsfmt" class="external-link">gdsfmt</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">## TODO: what is PATHMETA</span></span>
<span></span>
<span><span class="co">## The name of the GDS file that contains the 1KG information</span></span>
<span><span class="va">fileNameGDS</span> <span class="op">&lt;-</span> <span class="st">"matGeno1000g.gds"</span></span>
<span><span class="va">fileGDS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">PATHGDS</span>, <span class="va">fileNameGDS</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Files that will be created by the identifyRelative() function</span></span>
<span><span class="co">## The first RDS file will contain the kinship information between patients</span></span>
<span><span class="co">## The second RDS file will contain the list of unrelated patients</span></span>
<span><span class="va">fileIBD</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">PATHMETA</span>,<span class="st">"ibd.All.0.05.rds"</span><span class="op">)</span></span>
<span><span class="va">filePart</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">PATHMETA</span>,<span class="st">"part.All.0.05.rds"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Open the 1KG GDS file</span></span>
<span><span class="va">gds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SNPRelate/man/snpgdsOpen.html" class="external-link">snpgdsOpen</a></span><span class="op">(</span><span class="va">fileGDS</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Identify the genetically related patients in 1KG</span></span>
<span><span class="fu"><a href="../reference/identifyRelative.html">identifyRelative</a></span><span class="op">(</span>gds<span class="op">=</span><span class="va">fileGDS</span>, maf<span class="op">=</span><span class="fl">0.05</span>, thresh <span class="op">=</span> <span class="fl">2</span><span class="op">^</span><span class="op">(</span><span class="op">-</span><span class="fl">11</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>                        fileIBD<span class="op">=</span><span class="va">fileIBD</span>, filePart<span class="op">=</span><span class="va">filePart</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Close the 1KG GDS file</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/gdsfmt/man/closefn.gds.html" class="external-link">closefn.gds</a></span><span class="op">(</span><span class="va">gds</span><span class="op">)</span></span></code></pre></div>
<p><br><br></p>
</div>
<div class="section level3">
<h3 id="add-information-about-unrelated-patients-to-the-1kg-gds-file">Add information about unrelated patients to the 1KG GDS file<a class="anchor" aria-label="anchor" href="#add-information-about-unrelated-patients-to-the-1kg-gds-file"></a>
</h3>
<p>Only the unrelated patients from 1KG are used in the following
ancestry inference and kept in the GDS 1KG file. The function
<strong>identifyRelative()</strong> identifies the unrelated patients
and saves the information about those patients in an intermediate
external file.</p>
<p>The function <strong>addRef2GDS1KG()</strong> is adding the
information about the unrelated patients to the GDS 1KG file using the
intermediate external file.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Add the information about the unrelated 1KG patients to the 1KG GDS file</span></span>
<span><span class="fu"><a href="../reference/addRef2GDS1KG.html">addRef2GDS1KG</a></span><span class="op">(</span>fileGDS<span class="op">=</span><span class="va">gds</span>,  filePart<span class="op">=</span><span class="va">filePart</span><span class="op">)</span></span></code></pre></div>
<p><br><br></p>
</div>
<div class="section level3">
<h3 id="create-a-second-gds-containing-the-1kg-phase-information">Create a second GDS containing the 1KG phase information<a class="anchor" aria-label="anchor" href="#create-a-second-gds-containing-the-1kg-phase-information"></a>
</h3>
<p>We generate a GDS with the phase information.</p>
<p>The function <strong>generatePhase1KG2GDS()</strong> is adding the
phase information into the newly created 1KG GDS phase file.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Load required package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/zhengxwen/gdsfmt" class="external-link">gdsfmt</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">## The name of the 1KG GDS file that already exists</span></span>
<span><span class="va">fileGDS1KG</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">PATHGDS</span>, <span class="st">"matGeno1000g.gds"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## The name of the 1KG Phase GDS file that will be created</span></span>
<span><span class="va">fileGDSPhase</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">PATHGDS</span>, <span class="st">"matPhase1000g.gds"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Open the 1KG GDS file</span></span>
<span><span class="va">gds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gdsfmt/man/openfn.gds.html" class="external-link">openfn.gds</a></span><span class="op">(</span><span class="va">fileGDS1KG</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Create the 1KG Phase GDS file</span></span>
<span><span class="va">gdsPhase</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gdsfmt/man/createfn.gds.html" class="external-link">createfn.gds</a></span><span class="op">(</span><span class="va">fileGDSPhase</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Add the phase information to the 1KG Phase GDSfile</span></span>
<span><span class="fu"><a href="../reference/generatePhase1KG2GDS.html">generatePhase1KG2GDS</a></span><span class="op">(</span><span class="va">gds</span>, <span class="va">gdsPhase</span>, <span class="va">pathGeno</span>, <span class="va">fileLSNP.v</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Close both files</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/gdsfmt/man/closefn.gds.html" class="external-link">closefn.gds</a></span><span class="op">(</span><span class="va">gdsPhase</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/gdsfmt/man/closefn.gds.html" class="external-link">closefn.gds</a></span><span class="op">(</span><span class="va">gds</span><span class="op">)</span></span></code></pre></div>
<p><br><br></p>
<div class="section level4">
<h4 id="create-a-vcf-file-containing-the-retained-snp-positions-from-1kg-gds-file">Create a VCF file containing the retained SNP positions from 1KG GDS
file<a class="anchor" aria-label="anchor" href="#create-a-vcf-file-containing-the-retained-snp-positions-from-1kg-gds-file"></a>
</h4>
<p>The <strong>snvListVCF()</strong> function is used to generate a VCF
file that contains the information of all retained SNPs from 1KG GDS
file:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Load required package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://krasnitzlab.github.io/RAIDS/" class="external-link">RAIDS</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Open the 1KG GDS file</span></span>
<span><span class="va">gds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SNPRelate/man/snpgdsOpen.html" class="external-link">snpgdsOpen</a></span><span class="op">(</span><span class="va">fileGDS1kg</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## The VCF file that will be created</span></span>
<span><span class="va">fileOUT</span> <span class="op">&lt;-</span> <span class="st">"SNPretained.VCF"</span></span>
<span></span>
<span><span class="co">## Generate the VCF with the retained SNP position</span></span>
<span><span class="fu"><a href="../reference/snvListVCF.html">snvListVCF</a></span><span class="op">(</span>gds<span class="op">=</span><span class="va">gds</span>, fileOUT<span class="op">=</span><span class="va">fileOUT</span>, offset<span class="op">=</span><span class="fl">1</span>, freqCutoff<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Close the 1KG GDS file</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/gdsfmt/man/closefn.gds.html" class="external-link">closefn.gds</a></span><span class="op">(</span><span class="va">gds</span><span class="op">)</span></span></code></pre></div>
<p>You should compress and indexing the newly created VCF file. Do do
so, you need to install <a href="http://www.htslib.org/download/" class="external-link">HTSlib</a> <span class="citation">(Bonfield et al. 2021)</span>.</p>
<p>In a terminal:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">## This in not a R script</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co">## This script is in bash</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co">## Compress the new VCF file (fileOUT parameter)</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="ex">bgzip</span> fileOUT</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co">## Index the new VCF file</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co">## HTSlib software is needed</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="ex">tabix</span> <span class="at">-p</span> vcf fileOUT.gz</span></code></pre></div>
<p><br><br></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="pre-processed-files-are-available">Pre-processed files are available<a class="anchor" aria-label="anchor" href="#pre-processed-files-are-available"></a>
</h2>
<p>Pre-processed files, such as the 1KG GDS file, are available at this
address:</p>
<p><a href="https://labshare.cshl.edu/shares/krasnitzlab/aicsPaper" class="external-link">https://labshare.cshl.edu/shares/krasnitzlab/aicsPaper</a></p>
<p>Beware that some of those files are voluminous.</p>
<p><br><br></p>
</div>
<div class="section level2">
<h2 id="session-info">Session info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<p>Here is the output of <code><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo()</a></code> on the system on
which this document was compiled:</p>
<pre><code><span><span class="co">## R version 4.3.0 beta (2023-04-06 r84184)</span></span>
<span><span class="co">## Platform: x86_64-pc-linux-gnu (64-bit)</span></span>
<span><span class="co">## Running under: Ubuntu 22.04.2 LTS</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span></span>
<span><span class="co">##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </span></span>
<span><span class="co">##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   </span></span>
<span><span class="co">##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span></span>
<span><span class="co">##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span></span>
<span><span class="co">## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## time zone: UTC</span></span>
<span><span class="co">## tzcode source: system (glibc)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">## [1] RAIDS_0.99.3     GENESIS_2.29.0   SNPRelate_1.33.2 gdsfmt_1.35.9   </span></span>
<span><span class="co">## [5] knitr_1.42       BiocStyle_2.27.1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##   [1] jsonlite_1.8.4              magrittr_2.0.3             </span></span>
<span><span class="co">##   [3] GenomicFeatures_1.51.4      logistf_1.24.1             </span></span>
<span><span class="co">##   [5] rmarkdown_2.21              fs_1.6.1                   </span></span>
<span><span class="co">##   [7] BiocIO_1.9.2                zlibbioc_1.45.0            </span></span>
<span><span class="co">##   [9] ragg_1.2.5                  vctrs_0.6.1                </span></span>
<span><span class="co">##  [11] memoise_2.0.1               Rsamtools_2.15.3           </span></span>
<span><span class="co">##  [13] RCurl_1.98-1.12             quantsmooth_1.65.0         </span></span>
<span><span class="co">##  [15] htmltools_0.5.5             progress_1.2.2             </span></span>
<span><span class="co">##  [17] curl_5.0.0                  broom_1.0.4                </span></span>
<span><span class="co">##  [19] pROC_1.18.0                 sass_0.4.5                 </span></span>
<span><span class="co">##  [21] bslib_0.4.2                 desc_1.4.2                 </span></span>
<span><span class="co">##  [23] plyr_1.8.8                  sandwich_3.0-2             </span></span>
<span><span class="co">##  [25] zoo_1.8-11                  cachem_1.0.7               </span></span>
<span><span class="co">##  [27] GenomicAlignments_1.35.1    lifecycle_1.0.3            </span></span>
<span><span class="co">##  [29] pkgconfig_2.0.3             Matrix_1.5-4               </span></span>
<span><span class="co">##  [31] R6_2.5.1                    fastmap_1.1.1              </span></span>
<span><span class="co">##  [33] GenomeInfoDbData_1.2.10     MatrixGenerics_1.11.1      </span></span>
<span><span class="co">##  [35] digest_0.6.31               GWASTools_1.45.0           </span></span>
<span><span class="co">##  [37] AnnotationDbi_1.61.2        S4Vectors_0.37.5           </span></span>
<span><span class="co">##  [39] rprojroot_2.0.3             textshaping_0.3.6          </span></span>
<span><span class="co">##  [41] GenomicRanges_1.51.4        RSQLite_2.3.1              </span></span>
<span><span class="co">##  [43] filelock_1.0.2              fansi_1.0.4                </span></span>
<span><span class="co">##  [45] httr_1.4.5                  mgcv_1.8-42                </span></span>
<span><span class="co">##  [47] compiler_4.3.0              bit64_4.0.5                </span></span>
<span><span class="co">##  [49] backports_1.4.1             BiocParallel_1.33.12       </span></span>
<span><span class="co">##  [51] DBI_1.1.3                   highr_0.10                 </span></span>
<span><span class="co">##  [53] biomaRt_2.55.4              MASS_7.3-58.4              </span></span>
<span><span class="co">##  [55] quantreg_5.95               rappdirs_0.3.3             </span></span>
<span><span class="co">##  [57] DelayedArray_0.25.0         rjson_0.2.21               </span></span>
<span><span class="co">##  [59] DNAcopy_1.73.0              tools_4.3.0                </span></span>
<span><span class="co">##  [61] lmtest_0.9-40               glue_1.6.2                 </span></span>
<span><span class="co">##  [63] restfulr_0.0.15             nlme_3.1-162               </span></span>
<span><span class="co">##  [65] grid_4.3.0                  generics_0.1.3             </span></span>
<span><span class="co">##  [67] operator.tools_1.6.3        BSgenome_1.67.4            </span></span>
<span><span class="co">##  [69] formula.tools_1.7.1         class_7.3-21               </span></span>
<span><span class="co">##  [71] tidyr_1.3.0                 ensembldb_2.23.2           </span></span>
<span><span class="co">##  [73] data.table_1.14.8           hms_1.1.3                  </span></span>
<span><span class="co">##  [75] xml2_1.3.3                  utf8_1.2.3                 </span></span>
<span><span class="co">##  [77] XVector_0.39.0              BiocGenerics_0.45.3        </span></span>
<span><span class="co">##  [79] GWASExactHW_1.01            pillar_1.9.0               </span></span>
<span><span class="co">##  [81] stringr_1.5.0               splines_4.3.0              </span></span>
<span><span class="co">##  [83] dplyr_1.1.1                 BiocFileCache_2.7.2        </span></span>
<span><span class="co">##  [85] lattice_0.21-8              survival_3.5-5             </span></span>
<span><span class="co">##  [87] rtracklayer_1.59.1          bit_4.0.5                  </span></span>
<span><span class="co">##  [89] SparseM_1.81                tidyselect_1.2.0           </span></span>
<span><span class="co">##  [91] SeqVarTools_1.37.0          Biostrings_2.67.2          </span></span>
<span><span class="co">##  [93] bookdown_0.33               IRanges_2.33.1             </span></span>
<span><span class="co">##  [95] ProtGenerics_1.31.0         SummarizedExperiment_1.29.1</span></span>
<span><span class="co">##  [97] stats4_4.3.0                xfun_0.38                  </span></span>
<span><span class="co">##  [99] Biobase_2.59.0              matrixStats_0.63.0         </span></span>
<span><span class="co">## [101] stringi_1.7.12              lazyeval_0.2.2             </span></span>
<span><span class="co">## [103] yaml_2.3.7                  evaluate_0.20              </span></span>
<span><span class="co">## [105] codetools_0.2-19            tibble_3.2.1               </span></span>
<span><span class="co">## [107] BiocManager_1.30.20         cli_3.6.1                  </span></span>
<span><span class="co">## [109] systemfonts_1.0.4           jquerylib_0.1.4            </span></span>
<span><span class="co">## [111] Rcpp_1.0.10                 GenomeInfoDb_1.35.16       </span></span>
<span><span class="co">## [113] dbplyr_2.3.2                png_0.1-8                  </span></span>
<span><span class="co">## [115] XML_3.99-0.14               parallel_4.3.0             </span></span>
<span><span class="co">## [117] MatrixModels_0.5-1          pkgdown_2.0.7              </span></span>
<span><span class="co">## [119] blob_1.2.4                  prettyunits_1.1.1          </span></span>
<span><span class="co">## [121] AnnotationFilter_1.23.0     bitops_1.0-7               </span></span>
<span><span class="co">## [123] SeqArray_1.39.2             purrr_1.0.1                </span></span>
<span><span class="co">## [125] crayon_1.5.2                rlang_1.1.0                </span></span>
<span><span class="co">## [127] KEGGREST_1.39.0             mice_3.15.0</span></span></code></pre>
<p><br><br></p>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Bonfield2021" class="csl-entry">
Bonfield, James K, John Marshall, Petr Danecek, Heng Li, Valeriu Ohan,
Andrew Whitwham, Thomas Keane, and Robert M Davies. 2021. <span>“<span class="nocase">HTSlib: C library for reading/writing high-throughput
sequencing data</span>.”</span> <em>GigaScience</em> 10 (2). <a href="https://doi.org/10.1093/gigascience/giab007" class="external-link">https://doi.org/10.1093/gigascience/giab007</a>.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Pascal Belleau, Astrid Deschênes, Alexander Krasnitz.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
