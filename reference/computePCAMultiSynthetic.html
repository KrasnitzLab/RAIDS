<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Project synthetic profiles onto existing principal component axes
generated using the reference 1KG profiles — computePCAMultiSynthetic • RAIDS</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Project synthetic profiles onto existing principal component axes
generated using the reference 1KG profiles — computePCAMultiSynthetic"><meta property="og:description" content="The function projects  the synthetic profiles onto existing
principal component axes generated using the reference 1KG profiles. The
reference profiles used to generate the synthetic profiles have previously
been removed from the set of reference profiles."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RAIDS</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.99.10</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/RAIDS.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Create_Reference_GDS_File.html">Population reference dataset GDS files</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/KrasnitzLab/RAIDS/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Project synthetic profiles onto existing principal component axes
generated using the reference 1KG profiles</h1>
    <small class="dont-index">Source: <a href="https://github.com/KrasnitzLab/RAIDS/blob/HEAD/R/processStudy.R" class="external-link"><code>R/processStudy.R</code></a></small>
    <div class="hidden name"><code>computePCAMultiSynthetic.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The function projects  the synthetic profiles onto existing
principal component axes generated using the reference 1KG profiles. The
reference profiles used to generate the synthetic profiles have previously
been removed from the set of reference profiles.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">computePCAMultiSynthetic</span><span class="op">(</span></span>
<span>  <span class="va">gdsProfile</span>,</span>
<span>  <span class="va">listPCA</span>,</span>
<span>  <span class="va">sampleRef</span>,</span>
<span>  <span class="va">studyIDSyn</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>gdsProfile</dt>
<dd><p>an object of class <a href="https://rdrr.io/pkg/gdsfmt/man/gds.class.html" class="external-link">gds.class</a> (a GDS file),
an opened Profile GDS file.</p></dd>


<dt>listPCA</dt>
<dd><p>a <code>list</code> containing the PCA <code>object</code> generated
with the 1KG reference profiles (excluding the ones used to generate the
synthetic data set) in an entry called <code>"pca.unrel"</code>.</p></dd>


<dt>sampleRef</dt>
<dd><p>a <code>vector</code> of <code>character</code> strings representing
the identifiers of the 1KG reference profiles that have been used to
generate the synthetic profiles
that are going to be analysed here. The sub-continental
identifiers are used as names for the <code>vector</code>.</p></dd>


<dt>studyIDSyn</dt>
<dd><p>a <code>character</code> string corresponding to the study
identifier.
The study identifier must be present in the Profile GDS file.</p></dd>


<dt>verbose</dt>
<dd><p>a <code>logical</code> indicating if messages should be printed
to show how the different steps in the function. Default: <code>FALSE</code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>a <code>list</code> containing 3 entries:</p><ul><li><p>sample.id  a <code>vector</code> of <code>character</code> strings representing
the identifiers of the synthetic profiles that have been projected onto
the 1KG PCA.</p></li>
<li><p>eigenvector.ref  a <code>matrix</code> of <code>numeric</code> with the
eigenvectors of the 1KG reference profiles used to generate the PCA.</p></li>
<li><p>eigenvector  a <code>matrix</code> of <code>numeric</code> with the
eigenvectors of the synthetic profiles projected onto the 1KG PCA.</p></li>
</ul></div>
    <div id="author">
    <h2>Author</h2>
    <p>Pascal Belleau, Astrid Deschênes and Alexander Krasnitz</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Required library</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/zhengxwen/gdsfmt" class="external-link">gdsfmt</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Path to the demo Profile GDS file is located in this package</span></span></span>
<span class="r-in"><span><span class="va">dataDir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/demoKNNSynthetic"</span>, package<span class="op">=</span><span class="st">"RAIDS"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The name of the synthetic study</span></span></span>
<span class="r-in"><span><span class="va">studyID</span> <span class="op">&lt;-</span> <span class="st">"MYDATA.Synthetic"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">samplesRM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"HG00246"</span>, <span class="st">"HG00325"</span>, <span class="st">"HG00611"</span>, <span class="st">"HG01173"</span>, <span class="st">"HG02165"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"HG01112"</span>, <span class="st">"HG01615"</span>, <span class="st">"HG01968"</span>, <span class="st">"HG02658"</span>, <span class="st">"HG01850"</span>, <span class="st">"HG02013"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"HG02465"</span>, <span class="st">"HG02974"</span>, <span class="st">"HG03814"</span>, <span class="st">"HG03445"</span>, <span class="st">"HG03689"</span>, <span class="st">"HG03789"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"NA12751"</span>, <span class="st">"NA19107"</span>, <span class="st">"NA18548"</span>, <span class="st">"NA19075"</span>, <span class="st">"NA19475"</span>, <span class="st">"NA19712"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"NA19731"</span>, <span class="st">"NA20528"</span>, <span class="st">"NA20908"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">samplesRM</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GBR"</span>, <span class="st">"FIN"</span>, <span class="st">"CHS"</span>,<span class="st">"PUR"</span>, <span class="st">"CDX"</span>, <span class="st">"CLM"</span>, <span class="st">"IBS"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"PEL"</span>, <span class="st">"PJL"</span>, <span class="st">"KHV"</span>, <span class="st">"ACB"</span>, <span class="st">"GWD"</span>, <span class="st">"ESN"</span>, <span class="st">"BEB"</span>, <span class="st">"MSL"</span>, <span class="st">"STU"</span>, <span class="st">"ITU"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"CEU"</span>, <span class="st">"YRI"</span>, <span class="st">"CHB"</span>, <span class="st">"JPT"</span>, <span class="st">"LWK"</span>, <span class="st">"ASW"</span>, <span class="st">"MXL"</span>, <span class="st">"TSI"</span>, <span class="st">"GIH"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## The PCA on the 1KG reference profiles</span></span></span>
<span class="r-in"><span><span class="va">pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">dataDir</span>, <span class="st">"pca1KG.RDS"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Open the Profile GDS file</span></span></span>
<span class="r-in"><span><span class="va">gdsProfile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SNPRelate/man/snpgdsOpen.html" class="external-link">snpgdsOpen</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">dataDir</span>, <span class="st">"ex1.gds"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Projects synthetic profiles on 1KG PCA</span></span></span>
<span class="r-in"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu">computePCAMultiSynthetic</span><span class="op">(</span>gdsProfile<span class="op">=</span><span class="va">gdsProfile</span>, listPCA<span class="op">=</span><span class="va">pca</span>,</span></span>
<span class="r-in"><span>    sampleRef<span class="op">=</span><span class="va">samplesRM</span>, studyIDSyn<span class="op">=</span><span class="va">studyID</span>, verbose<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## The eigenvectors for the synthetic profiles</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">eigenvector</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                       [,1]         [,2]         [,3]         [,4]         [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.ex1.HG00246.1 0.06469191 -0.004653002 -0.088967175 -0.060291452  0.031812132</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.ex1.HG00325.1 0.09115431 -0.004743912 -0.071907454  0.044100229 -0.041522503</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.ex1.HG00611.1 0.01381479 -0.017912275  0.062489822  0.003760931  0.061062765</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.ex1.HG01173.1 0.02193600  0.016635981 -0.123902643 -0.104948054  0.021495661</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.ex1.HG02165.1 0.15626481 -0.003083060 -0.004768404  0.100910618 -0.002478422</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.ex1.HG01112.1 0.07699686 -0.015195235 -0.102489655 -0.088759431 -0.031143964</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                         [,6]         [,7]        [,8]        [,9]        [,10]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.ex1.HG00246.1 -0.087084898 -0.002319659 -0.01327109 -0.06600164  0.011422042</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.ex1.HG00325.1  0.092420817 -0.150333993  0.04064972  0.06185469  0.045882592</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.ex1.HG00611.1  0.006946086  0.037328105  0.01327867 -0.03629313  0.015773551</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.ex1.HG01173.1  0.026114397 -0.045510755 -0.02727912  0.12362088  0.005003337</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.ex1.HG02165.1 -0.213193715 -0.205975416 -0.33167160  0.01689627  0.415307845</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.ex1.HG01112.1  0.140457360 -0.129621812  0.18058981  0.09950699 -0.058262338</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                         [,11]        [,12]       [,13]       [,14]       [,15]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.ex1.HG00246.1  0.1135730541  0.120776205  0.05104489  0.10009894  0.08226945</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.ex1.HG00325.1 -0.0213545024  0.017612760 -0.12065696  0.11956275 -0.05519839</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.ex1.HG00611.1  0.0002207075  0.008803511  0.06544166  0.02462076  0.00500031</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.ex1.HG01173.1 -0.0877004088 -0.023906580 -0.11278874 -0.02636037 -0.09290133</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.ex1.HG02165.1  0.1492485496 -0.094433444 -0.10994232  0.06307073  0.06593791</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.ex1.HG01112.1 -0.1773609745 -0.105883583 -0.15020718  0.04382861 -0.04644355</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Close Profile GDS file (important)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/gdsfmt/man/closefn.gds.html" class="external-link">closefn.gds</a></span><span class="op">(</span><span class="va">gdsProfile</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Pascal Belleau, Astrid Deschênes, Alexander Krasnitz.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

